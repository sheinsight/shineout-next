# Input 组件 3.5.8 版本 Diff 报告

## 问题描述

修复 `Input` 开启 `digits` 且值为 0 的情况下依然可以输入小数的缺陷。这是 3.5.7 版本引入的回归问题。

## 代码变更文件

`packages/hooks/src/components/use-input/use-input-format.ts`

## 变更代码行

```diff
// 修正小数位数处理逻辑
const _value = v.split('.');
const __value = value.split('.');
-if (_value[1] !== undefined && __value[1] === undefined) {
+if (_value[1] !== undefined && __value[1] === undefined && digits !== 0) {
  value = `${value}.${_value[1]}`;
}
```

## 变更前后逻辑差异

### 变更前
- 3.5.7 版本优化小数处理时，没有考虑 `digits` 为 0 的特殊情况
- 当 `digits` 设置为 0 时，仍然会保留小数点和小数部分
- 导致整数输入模式失效

### 变更后
- 增加 `digits !== 0` 判断条件
- 当 `digits` 为 0 时，不执行小数部分的保留逻辑
- 确保整数输入模式正常工作

## 逻辑影响范围
- 修复了 `digits={0}` 时仍可输入小数的回归问题
- 恢复了整数输入模式的正确行为
- 不影响 `digits` 大于 0 的正常小数输入功能

## 升级注意事项

### 代码兼容性
- **无破坏性变更**：修复了 3.5.7 版本引入的回归缺陷

### 行为变化说明

1. **整数输入模式恢复正常**：
   - 升级前（3.5.7）：设置 `digits={0}` 后仍可输入小数点和小数
   - 升级后：`digits={0}` 时只能输入整数，小数点被自动过滤
   - 受影响场景：
     ```tsx
     // 需要纯整数输入的场景
     <Input 
       type="number"
       digits={0}
       placeholder="请输入整数"
     />
     // 升级前：可以输入 "123.45"
     // 升级后：输入 "123.45" 会自动变为 "123"
     ```
   - 是否需要调整：不需要，这是回归缺陷修复

2. **小数输入不受影响**：
   - 升级前后：`digits` 大于 0 时的行为保持一致
   - 受影响场景：正常的小数输入场景不受影响
   - 示例代码：
     ```tsx
     <Input 
       type="number"
       digits={2}  // 允许两位小数
     />
     ```
   - 是否需要调整：不需要